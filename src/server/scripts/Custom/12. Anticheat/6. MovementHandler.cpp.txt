1. src/server/game/Handlers/MovementHandler.cpp
1.1 Agregar:
 * with this program. If not, see <http://www.gnu.org/licenses/>.
 */

+#include "AnticheatMgr.h"
#include "Battleground.h"
#include "Common.h"
#include "Corpse.h"

2. src/server/game/Handlers/MovementHandler.cpp
2.1 Agregar:
    if (opcode == MSG_MOVE_FALL_LAND || opcode == MSG_MOVE_START_SWIM)
        mover->RemoveAurasWithInterruptFlags(AURA_INTERRUPT_FLAG_LANDING); // Parachutes

+    if (plrMover)
+        sAnticheatMgr->StartHackDetection(plrMover, movementInfo, opcode);
    /* process position-change */
    WorldPacket data(opcode, recvData.size());
    int64 movementTime = (int64) movementInfo.time + _timeSyncClockDelta;

3. src/server/game/Handlers/MovementHandler.cpp
3.1 Agregar:
    WorldPacket data(MSG_MOVE_KNOCK_BACK, 66);
    WriteMovementInfo(&data, &movementInfo);
-
+    _player->SetCanTeleport(true);
    // knockback specific info
    data << movementInfo.jump.sinAngle;
    data << movementInfo.jump.cosAngle;